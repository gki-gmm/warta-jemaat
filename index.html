<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warta Jemaat Online</title>
    
    <!-- Favicon dummy -->
    <link rel="icon" href="data:,">

    <style>
        :root {
            --bg-color: #ffffff;
            --paper-color: #fdfbf7;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at center, #f3f9ff 0%, #eff6fd 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: sans-serif;
            overflow: hidden;
        }

        /* Loading Overlay */
        #loading {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            transition: opacity 0.5s;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Container Buku */
        .book-container {
            position: relative;
            box-shadow: 0 25px 60px rgba(0,0,0,0.6);
        }

        #flipbook {
            display: none; /* Disembunyikan sampai gambar siap */
        }

        /* Styling Halaman */
        .page {
            background-color: var(--paper-color);
            overflow: hidden;
        }

        .page img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Agar gambar tidak gepeng */
            display: block;
        }

        /* Shadow effect untuk kedalaman */
        .page {
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }

        /* Controls Navigasi */
        .controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            padding: 10px 20px;
            border-radius: 50px;
            display: flex;
            gap: 15px;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .controls.active {
            opacity: 1;
            pointer-events: all;
        }

        .btn {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            font-size: 20px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .btn:hover {
            background: white;
            color: #333;
        }

        /* Pesan Error jika gambar tidak ketemu */
        #error-msg {
            display: none;
            color: #ff6b6b;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div id="loading">
        <div class="spinner"></div>
        <div id="loading-text">Memuat Buku...</div>
    </div>

    <!-- Error Message -->
    <div id="error-msg">
        <h3>Gagal Memuat</h3>
        <p>Pastikan folder <strong>img</strong> ada dan berisi gambar bernama 1.jpg, 2.jpg, dst.</p>
    </div>

    <!-- Area Buku -->
    <div class="book-container">
        <div id="flipbook">
            <!-- Halaman akan di-generate otomatis via JS -->
        </div>
    </div>

    <!-- Tombol Navigasi -->
    <div class="controls" id="controls">
        <button class="btn" onclick="prevPage()">&#10094;</button>
        <button class="btn" onclick="nextPage()">&#10095;</button>
    </div>

    <!-- Libraries (jQuery & Turn.js) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/3/turn.min.js"></script>

    <script>
        // ==========================================
        // PENGATURAN (Sesuaikan di sini)
        // ==========================================
        const CONFIG = {
            folderName: 'img',      // Nama folder gambar Anda
            totalImages: 18,        // JUMLAH TOTAL GAMBAR (Ubah angka ini!)
            fileExtension: '.jpg',  // Format gambar (.jpg atau .png)
            baseWidth: 900          // Lebar dasar buku di desktop
        };

        // ==========================================
        // LOGIKA PROGRAM
        // ==========================================
        
        let bookWidth = 0;
        let bookHeight = 0;
        let isMobile = window.innerWidth <= 768;

        $(document).ready(function() {
            initBook();
        });

        function initBook() {
            const flipbook = $('#flipbook');
            const loadingText = $('#loading-text');

            // 1. Preload Gambar Pertama untuk mengetahui Aspek Rasio (Tinggi/Lebar)
            const firstImgPath = `${CONFIG.folderName}/1${CONFIG.fileExtension}`;
            const tempImg = new Image();
            
            tempImg.src = firstImgPath;
            
            tempImg.onload = function() {
                // Hitung rasio berdasarkan gambar asli
                const aspectRatio = this.naturalHeight / this.naturalWidth;

                // Tentukan Ukuran Buku
                if (isMobile) {
                    // Mobile: Lebar mengikuti layar - padding
                    bookWidth = window.innerWidth - 30; 
                    bookHeight = bookWidth * aspectRatio;
                } else {
                    // Desktop: Lebar fix sesuai config, tinggi menyesuaikan
                    bookWidth = CONFIG.baseWidth;
                    bookHeight = bookWidth * (aspectRatio / 2); // Dibagi 2 karena 2 halaman
                }

                // 2. Generate Halaman ke DOM
                generatePages(aspectRatio);

                // 3. Inisialisasi Turn.js
                setupTurnJs();
                
                // 4. Tampilkan Buku & Sembunyikan Loading
                flipbook.show();
                $('#loading').fadeOut();
                $('#controls').addClass('active');
            };

            tempImg.onerror = function() {
                $('#loading').hide();
                $('#error-msg').show();
                console.error("Gagal memuat gambar pertama: " + firstImgPath);
            };
        }

        function generatePages(aspectRatio) {
            const flipbook = $('#flipbook');
            const loadingText = $('#loading-text');
            flipbook.empty();

            // Loop dari 1 sampai totalImages
            for (let i = 1; i <= CONFIG.totalImages; i++) {
                const imgPath = `${CONFIG.folderName}/${i}${CONFIG.fileExtension}`;
                
                // Buat elemen div page
                const pageDiv = document.createElement('div');
                pageDiv.className = 'page';
                
                // Set ukuran halaman
                const pageWidth = isMobile ? bookWidth : (bookWidth / 2);
                pageDiv.style.width = pageWidth + 'px';
                pageDiv.style.height = bookHeight + 'px';

                // Buat elemen gambar
                const img = document.createElement('img');
                img.src = imgPath;
                img.alt = `Halaman ${i}`;
                
                // Event untuk update loading text
                img.onload = function() {
                    loadingText.text(`Memuat Halaman ${i}/${CONFIG.totalImages}...`);
                };
                img.onerror = function() {
                    console.warn(`Gambar ${i} tidak ditemukan.`);
                };

                pageDiv.appendChild(img);
                flipbook.append(pageDiv);
            }
        }

        function setupTurnJs() {
            const flipbook = $('#flipbook');
            
            flipbook.turn({
                width: bookWidth,
                height: bookHeight,
                autoCenter: true,
                duration: 800,
                acceleration: true,
                gradients: true,
                elevation: 50,
                display: isMobile ? "single" : "double",
                when: {
                    turning: function(e, page, view) {
                        // Optional: Log saat berpindah
                    }
                }
            });
        }

        // Fungsi Navigasi
        window.prevPage = function() {
            $("#flipbook").turn("previous");
        }
        window.nextPage = function() {
            $("#flipbook").turn("next");
        }

        // Handle Window Resize
        let resizeTimeout;
        $(window).resize(function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                // Jika mode berubah (Mobile <-> Desktop), reload halaman
                const newIsMobile = window.innerWidth <= 768;
                if (newIsMobile !== isMobile) {
                    location.reload(); 
                }
            }, 300);
        });

    </script>
</body>
</html>
